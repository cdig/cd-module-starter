@mixin magic-underline($color, $backgroundColor, $selectionColor) {
	@include textShadowToCropUnderline($backgroundColor);
	background-image:
		linear-gradient($backgroundColor, $backgroundColor),
		linear-gradient($backgroundColor, $backgroundColor),
		linear-gradient($color, $color);
	background-size: .05em 2px, .05em 2px, 1px 2px;
	background-repeat: no-repeat, no-repeat, repeat-x;
	background-position: left bottom .1em, right bottom .1em, left bottom .1em;
	
	&::selection {
		@include textShadowToCropUnderline($selectionColor);
		background: $selectionColor;
	}
	
	&:before, &:after, *, *:before, *:after {
		text-shadow: none;
	}
}

@mixin textShadowToCropUnderline($shadowColor) {
	text-shadow:
		0  2px $shadowColor,
		0 -2px $shadowColor,
		0 -3px $shadowColor, // Helps  g
		 2px 0 $shadowColor,
		-2px 0 $shadowColor,
		 3px 0 $shadowColor, // Helps y
		 4px 0 $shadowColor,
		-4px 0 $shadowColor;
}

// Generated by CoffeeScript 1.8.0
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  (function() {
    var EVENTS, allNeedsAreMet, alreadyChecking, checkWaitingTakers, eventName, makeHandler, notify, valuesByName, waitingTakers, _i, _len, _results;
    EVENTS = ["beforeunload", "click", "load", "unload"];
    valuesByName = {};
    waitingTakers = [];
    alreadyChecking = false;
    window.Make = function(name, value) {
      if (valuesByName[name] != null) {
        throw new Error("You may not Make() the same name twice: " + name);
      }
      valuesByName[name] = value != null ? value : name;
      return checkWaitingTakers();
    };
    window.Take = function(needs, callback) {
      var taker;
      if (typeof needs === "string") {
        needs = [needs];
      }
      taker = {
        needs: needs,
        callback: callback
      };
      if (allNeedsAreMet(needs)) {
        return setTimeout(function() {
          return notify(taker);
        });
      } else {
        return waitingTakers.push(taker);
      }
    };
    checkWaitingTakers = function() {
      var index, taker, _i, _len;
      if (alreadyChecking) {
        return;
      }
      alreadyChecking = true;
      for (index = _i = 0, _len = waitingTakers.length; _i < _len; index = ++_i) {
        taker = waitingTakers[index];
        if (allNeedsAreMet(taker.needs)) {
          waitingTakers.splice(index, 1);
          notify(taker);
          alreadyChecking = false;
          return checkWaitingTakers();
        }
      }
      return alreadyChecking = false;
    };
    allNeedsAreMet = function(needs) {
      return needs.every(function(name) {
        return valuesByName[name] != null;
      });
    };
    notify = function(taker) {
      var name, resolvedNeeds;
      resolvedNeeds = (function() {
        var _i, _len, _ref, _results;
        _ref = taker.needs;
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          name = _ref[_i];
          _results.push(valuesByName[name]);
        }
        return _results;
      })();
      return taker.callback.apply(null, resolvedNeeds);
    };
    makeHandler = function(eventName) {
      var handler;
      return handler = function(eventObject) {
        window.removeEventListener(eventName, handler);
        Make(eventName, eventObject);
        return null;
      };
    };
    _results = [];
    for (_i = 0, _len = EVENTS.length; _i < _len; _i++) {
      eventName = EVENTS[_i];
      _results.push(window.addEventListener(eventName, makeHandler(eventName)));
    }
    return _results;
  })();

  Take("load", function() {
    var applyPosToElement, beginDrag, computeCSSRules, disableCursor, downHandler, dragHandler, dropHandler, editableElements, endDrag, extractLastClass, getContainingEditable, hudButton, lastMousePos, manipulatedElements, outputContainer, outputField, setEvents, styleValToNumWithPrecision, target, toFormattedCSSRule, updateDrag, updateField, vec, vecFromElementPos;
    editableElements = document.querySelectorAll("[editable]");
    if (!editableElements.length) {
      return;
    }
    setTimeout(function() {
      return setEvents("init");
    });
    target = null;
    manipulatedElements = {};
    outputField = document.createElement("textarea");
    outputContainer = document.createElement("editor-container");
    outputContainer.className = "selectable";
    outputContainer.appendChild(outputField);
    document.body.appendChild(outputContainer);
    hudButton = document.createElement("editor-button");
    hudButton.textContent = "Editor Output";
    hudButton.addEventListener("click", function() {
      return outputContainer.classList.toggle("show");
    });
    Take("cdHUD", function(cdHUD) {
      return cdHUD.addElement(hudButton);
    });
    vec = {
      create: function(x, y) {
        if (x == null) {
          x = 0;
        }
        if (y == null) {
          y = 0;
        }
        return {
          x: x,
          y: y
        };
      },
      fromEventClient: function(e) {
        return vec.create(e.clientX, e.clientY);
      },
      add: function(a, b) {
        return vec.create(a.x + b.x, a.y + b.y);
      },
      subtract: function(a, b) {
        return vec.create(a.x - b.x, a.y - b.y);
      },
      scalarMultiply: function(v, s) {
        return vec.create(v.x * s, v.y * s);
      },
      scalarDivide: function(v, s) {
        return vec.create(v.x / s, v.y / s);
      }
    };
    getContainingEditable = function(elm) {
      if (elm == null) {
        return null;
      } else if (elm.matches("[editable]")) {
        return elm;
      } else if (elm.parentElement != null) {
        return getContainingEditable(elm.parentElement);
      } else {
        return null;
      }
    };
    vecFromElementPos = function(elm) {
      var left, marginTop, style;
      style = window.getComputedStyle(elm);
      left = parseInt(style.left) / 100 * elm.offsetParent.offsetWidth;
      if (isNaN(left)) {
        left = 0;
      }
      marginTop = parseInt(style.marginTop);
      return vec.create(left, marginTop);
    };
    extractLastClass = function(elm) {
      return "." + elm.className.split(" ").pop();
    };
    computeCSSRules = function() {
      var elm, left, marginTop, rules, selector, selectors;
      selectors = Object.keys(manipulatedElements).sort();
      rules = (function() {
        var _i, _len, _results;
        _results = [];
        for (_i = 0, _len = selectors.length; _i < _len; _i++) {
          selector = selectors[_i];
          elm = manipulatedElements[selector];
          left = styleValToNumWithPrecision(elm.style.left, 2);
          marginTop = styleValToNumWithPrecision(elm.style.marginTop, 2);
          _results.push(toFormattedCSSRule(selector, left, marginTop));
        }
        return _results;
      })();
      return rules.join("\n");
    };
    styleValToNumWithPrecision = function(n, p) {
      return parseFloat(n).toFixed(p).replace(/\0+$/, "").replace(/\.$/, "");
    };
    toFormattedCSSRule = function(selector, left, marginTop) {
      var s;
      s = "" + selector + " {\n";
      s += "\tleft: " + left + "%;\n";
      s += "\tmargin-top: " + marginTop + "%;\n";
      s += "}\n";
      return s;
    };
    lastMousePos = null;
    beginDrag = function(mousePos) {
      var _name;
      disableCursor(true);
      lastMousePos = mousePos;
      if (target.editorPos == null) {
        target.editorPos = vecFromElementPos(target);
      }
      return manipulatedElements[_name = extractLastClass(target)] != null ? manipulatedElements[_name] : manipulatedElements[_name] = target;
    };
    updateDrag = function(mousePos) {
      var deltaPos, normalizedPos, percentPos;
      deltaPos = vec.subtract(mousePos, lastMousePos);
      target.editorPos = vec.add(target.editorPos, deltaPos);
      normalizedPos = vec.scalarDivide(target.editorPos, target.offsetParent.offsetWidth);
      percentPos = vec.scalarMultiply(normalizedPos, 100);
      applyPosToElement(percentPos, target);
      return lastMousePos = mousePos;
    };
    endDrag = function() {
      disableCursor(false);
      return updateField(computeCSSRules());
    };
    applyPosToElement = function(pos, elm) {
      elm.style.left = pos.x + "%";
      return elm.style.marginTop = pos.y + "%";
    };
    updateField = function(value) {
      return outputField.value = value;
    };
    disableCursor = function(disable) {
      var fn;
      if (disable == null) {
        disable = true;
      }
      fn = disable ? "add" : "remove";
      return document.body.classList[fn]("editor-dragging");
    };
    downHandler = function(e) {
      target = getContainingEditable(e.target);
      if (target == null) {
        return;
      }
      beginDrag(vec.fromEventClient(e));
      setEvents("down");
      return e.preventDefault();
    };
    dragHandler = function(e) {
      updateDrag(vec.fromEventClient(e));
      return e.preventDefault();
    };
    dropHandler = function(e) {
      endDrag();
      setEvents("drop");
      return e.preventDefault();
    };
    return setEvents = function(situation) {
      switch (situation) {
        case "init":
          return window.addEventListener("mousedown", downHandler);
        case "down":
          window.removeEventListener("mousedown", downHandler);
          window.addEventListener("mousemove", dragHandler);
          return window.addEventListener("mouseup", dropHandler);
        case "drop":
          window.removeEventListener("mousemove", dragHandler);
          window.removeEventListener("mouseup", dropHandler);
          return window.addEventListener("mousedown", downHandler);
      }
    };
  });

  Take("load", function() {
    var buttons, hide, main, okayButton, popup;
    main = document.querySelector(".browser-support");
    popup = document.querySelector(".support-popup");
    buttons = document.createElement("div");
    okayButton = document.createElement("div");
    buttons.className = "support-buttons";
    okayButton.textContent = "Okay";
    buttons.appendChild(okayButton);
    popup.appendChild(buttons);
    hide = function() {
      return main.className = "browser-support hide";
    };
    return okayButton.addEventListener("click", hide);
  });

  Take("load", function() {
    var callOut, hide, makeNestedLabel, show, _i, _len, _ref, _results;
    makeNestedLabel = function(callOut) {
      var label;
      label = document.createElement("call-out-label");
      label.innerHTML = callOut.innerHTML;
      callOut.innerHTML = "";
      return callOut.appendChild(label);
    };
    show = function(e) {
      e.currentTarget.setAttribute("open", true);
      return e.currentTarget.setAttribute("seen", true);
    };
    hide = function(e) {
      return e.currentTarget.removeAttribute("open");
    };
    _ref = document.querySelectorAll("call-out");
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      callOut = _ref[_i];
      callOut.addEventListener("mouseover", show);
      callOut.addEventListener("mouseout", hide);
      _results.push(makeNestedLabel(callOut));
    }
    return _results;
  });

  Take("load", function() {
    var hud;
    hud = document.createElement("cd-hud");
    document.body.appendChild(hud);
    return Make("cdHUD", {
      addElement: function(element) {
        return hud.appendChild(element);
      }
    });
  });

  Take(["cdHUD", "PageScrollWatcher", "PageTitle"], function(cdHUD, PageScrollWatcher, PageTitle) {
    var indicator;
    indicator = document.createElement("current-page-indicator");
    cdHUD.addElement(indicator);
    PageScrollWatcher.onPageChange(function(page) {
      return indicator.textContent = PageTitle(page);
    });
    return Take("PageSwitcher", function(PageSwitcher) {
      var updatePosition;
      indicator.addEventListener("click", function() {
        return PageSwitcher.toggle();
      });
      updatePosition = function() {
        var x, y;
        x = indicator.offsetLeft;
        y = parseInt(window.getComputedStyle(indicator).height.split("px")[0]);
        return PageSwitcher.setPosition(x, y);
      };
      window.addEventListener("resize", updatePosition);
      return setTimeout(function() {
        return updatePosition();
      });
    });
  });

  Take(["cdHUD", "SaveWithPopup", "Params"], function(cdHUD, SaveWithPopup, Params) {
    var button, goToLauncher;
    goToLauncher = function() {
      return location.href = Params["launcher-url"];
    };
    button = document.createElement("menu-button");
    button.textContent = "Menu";
    button.addEventListener("click", function() {
      return SaveWithPopup(function(success) {
        if (success) {
          return setTimeout(goToLauncher, 500);
        }
      });
    });
    return cdHUD.addElement(button);
  });

  Take(["cdHUD", "PageAudio", "MuteButtonGraphic"], function(cdHUD, PageAudio, Graphic) {
    var button;
    button = document.createElement("mute-button");
    button.addEventListener("click", PageAudio.toggle);
    button.innerHTML = Graphic;
    cdHUD.addElement(button);
    return PageAudio.onUpdate(function(enabled) {
      if (enabled) {
        return button.firstChild.classList.remove("muted");
      } else {
        return button.firstChild.classList.add("muted");
      }
    });
  });

  Make("MuteButtonGraphic", '<svg height="1.5em" width="1.5em" viewBox="0 0 64 64" version="1.1" xmlns="http://www.w3.org/2000/svg"> <path d="m 37.991813,22.751636 -3.083782,3.083783 c 1.588254,1.572528 2.571897,3.753462 2.571897,6.164853 0,2.410848 -0.983643,4.592324 -2.571897,6.16431 l 3.083782,3.083782 c 2.364757,-2.368011 3.82775,-5.637242 3.82775,-9.248093 0,-3.611392 -1.462993,-6.880083 -3.82775,-9.248636 z" transform="matrix(1,0,0,1,0,0)"></path> <path d="m 50.496123,32 c 0,-6.005432 -2.440672,-11.440956 -6.383379,-15.369023 L 41.05987,19.68385 c 3.149937,3.15319 5.097703,7.506925 5.097703,12.31615 0,4.808682 -1.948309,9.162417 -5.097703,12.31615 l 3.052874,3.052873 C 48.055451,43.440956 50.496123,38.005431 50.496123,32 z" transform="matrix(1,0,0,1,0,0)"></path> <path d="m 59.173768,32.000271 c 0,-8.402181 -3.412386,-16.006711 -8.925453,-21.505137 l -3.068057,3.068056 c 4.72843,4.713247 7.654417,11.233274 7.654417,18.437081 0,7.203264 -2.925987,13.723833 -7.654417,18.436538 l 3.068057,3.068057 c 5.513067,-5.497884 8.925453,-13.102957 8.925453,-21.504595 z" transform="matrix(1,0,0,1,0,0)"></path> <polygon points="21.085,66 44,87.208 44,12.791 21.517,34 0,34 0,66 " transform="matrix(0.57539192,0,0,0.57539192,3.3431808,3.2306919)"></polygon> </svg>');

  Take(["cdHUD", "Scoring", "ScoreDisplayGraphic"], function(cdHUD, Scoring, Graphic) {
    var display, ring, update;
    display = document.createElement("score-display");
    display.innerHTML = Graphic;
    cdHUD.addElement(display);
    ring = display.querySelector(".ring");
    update = function(score) {
      var circumference, radius, strokeOffset;
      radius = ring.getAttribute("r");
      circumference = 2 * Math.PI * radius;
      strokeOffset = (1 - score) * circumference;
      ring.style.strokeDashoffset = strokeOffset;
      if (score >= 1) {
        return display.className = "complete";
      }
    };
    update(Scoring.getModuleScore());
    Take("ModalPopup", function(ModalPopup) {
      return display.addEventListener("click", function() {
        var score;
        score = Math.round(Scoring.getModuleScore() * 100);
        return ModalPopup.open("Scoring Status", "You are " + score + "% done the activities in this module.");
      });
    });
    return Make("ScoreDisplay", {
      getElement: function() {
        return display;
      },
      update: function(remainingPoints) {
        var currentPoints, currentScore, displayed, totalPoints;
        currentScore = Scoring.getModuleScore();
        totalPoints = Scoring.getModulePoints();
        currentPoints = currentScore * totalPoints;
        displayed = currentScore * (1 - remainingPoints / currentPoints);
        return update(displayed);
      }
    });
  });

  Make("ScoreDisplayGraphic", '<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid meet" version="1.1" xmlns="http://www.w3.org/2000/svg"> <g class="progress"> <circle class="disk" r="4" cx="10" cy="10"></circle> <circle class="ring" r="8" cx="10" cy="10"></circle> </g> <path class="check" d="M4.78087651,19 L8.20717126,19 C9.64143433,14.7225596 15.2191235,4.51075576 20,0.933259897 C19.0840496,0.640737737 18.1067545,0.406269457 16.4940242,1.77635684e-15 C13.4674935,1.24019577 7.75937204,10.7092455 6.69322715,12.9878649 C5.17928304,13.3767232 3.58565721,10.4991725 3.58565721,10.4991725 L0,12.8323217 C0,12.8323217 3.98406374,17.2112523 4.78087651,19 L4.78087651,19 Z"></path> </svg>');

  Take("load", function() {
    var buttons, content, fadeOut, hide, main, okayButton, popup, title;
    main = document.createElement("cd-modal");
    popup = document.createElement("modal-popup");
    title = document.createElement("h1");
    content = document.createElement("p");
    buttons = document.createElement("modal-buttons");
    okayButton = document.createElement("okay-button");
    buttons.appendChild(okayButton);
    popup.appendChild(title);
    popup.appendChild(content);
    popup.appendChild(buttons);
    main.appendChild(popup);
    document.body.appendChild(main);
    (hide = function() {
      return main.className = "hide";
    })();
    fadeOut = function() {
      main.className = "hiding";
      return setTimeout(hide, 500);
    };
    okayButton.textContent = "Okay";
    okayButton.addEventListener("click", fadeOut);
    return Make("ModalPopup", {
      open: function(givenTitle, givenContent, showButtons) {
        if (showButtons == null) {
          showButtons = true;
        }
        title.textContent = givenTitle;
        if (typeof givenContent === "string") {
          content.textContent = givenContent;
        } else {
          while (content.hasChildNodes()) {
            content.removeChild(content.lastChild);
          }
          content.appendChild(givenContent);
        }
        main.className = "show";
        if (showButtons) {
          return buttons.style.visibility = null;
        } else {
          return buttons.style.visibility = "hidden";
        }
      },
      close: function() {
        return fadeOut();
      }
    });
  });

  Take(["PageManager", "Scoring"], function(PageManager, Scoring) {
    var PageLocking, callbacks, lockedPage, pageShouldLock;
    lockedPage = null;
    callbacks = [];
    setTimeout(function() {
      return PageLocking.update();
    });
    Make("PageLocking", PageLocking = {
      getLockedPage: function() {
        return lockedPage;
      },
      update: function() {
        var call, page, _i, _j, _len, _len1, _ref, _results;
        if (lockedPage != null) {
          lockedPage.classList.remove("locked-page");
        }
        lockedPage = null;
        _ref = PageManager.getPages();
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          page = _ref[_i];
          page.classList.remove("hidden-by-locked-page");
          if (lockedPage != null) {
            page.classList.add("hidden-by-locked-page");
          } else if (pageShouldLock(page)) {
            lockedPage = page;
            page.classList.add("locked-page");
          }
        }
        _results = [];
        for (_j = 0, _len1 = callbacks.length; _j < _len1; _j++) {
          call = callbacks[_j];
          _results.push(call(lockedPage));
        }
        return _results;
      },
      onUpdate: function(callback) {
        return callbacks.push(callback);
      }
    });
    pageShouldLock = function(page) {
      var activity, _i, _len, _ref;
      _ref = page.querySelectorAll("cd-activity");
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        activity = _ref[_i];
        if (Scoring.getActivityScore(activity.id) < 1) {
          return true;
        }
      }
      return false;
    };
    return Scoring.onUpdate(function() {
      return PageLocking.update();
    });
  });

  Take(["ScrollTo", "PageTitle"], function(ScrollTo, PageTitle) {
    var makeScrollHandler;
    Make("SwitcherButton", function(page, pageIndex) {
      var button;
      button = document.createElement("a");
      button.className = "switcher-button";
      button.textContent = PageTitle(page);
      button.addEventListener("click", makeScrollHandler(page, button));
      return button;
    });
    return makeScrollHandler = function(page, button) {
      return function(e) {
        var pageTop, scrollPosition;
        if (button.classList.contains("locked")) {
          return;
        }
        scrollPosition = document.body.scrollTop;
        pageTop = page.offsetTop;
        return ScrollTo(scrollPosition, pageTop - scrollPosition);
      };
    };
  });

  Take(["PageManager", "SwitcherButton"], function(PageManager, SwitcherButton) {
    var PageSwitcher, enableOpen, page, pageIndex, switcher, switcherButtons, switcherOpen;
    switcherOpen = false;
    switcher = document.createElement("page-switcher");
    switcher.className = "closed";
    switcherButtons = (function() {
      var _i, _len, _ref, _results;
      _ref = PageManager.getPages();
      _results = [];
      for (pageIndex = _i = 0, _len = _ref.length; _i < _len; pageIndex = ++_i) {
        page = _ref[pageIndex];
        _results.push(switcher.appendChild(SwitcherButton(page, pageIndex)));
      }
      return _results;
    })();
    Take("PageLocking", function(PageLocking) {
      return PageLocking.onUpdate(function() {
        var _i, _len, _ref, _results;
        _ref = PageManager.getPages();
        _results = [];
        for (pageIndex = _i = 0, _len = _ref.length; _i < _len; pageIndex = ++_i) {
          page = _ref[pageIndex];
          if (page.classList.contains("locked")) {
            _results.push(switcherButtons[pageIndex].classList.add("locked"));
          } else {
            _results.push(switcherButtons[pageIndex].classList.remove("locked"));
          }
        }
        return _results;
      });
    });
    document.body.appendChild(switcher);
    Make("PageSwitcher", PageSwitcher = {
      open: function() {
        if (!switcherOpen) {
          return enableOpen(true);
        }
      },
      close: function() {
        if (switcherOpen) {
          return enableOpen(false);
        }
      },
      toggle: function() {
        if (switcherOpen) {
          return PageSwitcher.close();
        } else {
          return PageSwitcher.open();
        }
      },
      setPosition: function(x, y) {
        y += 10;
        switcher.style.left = "" + x + "px";
        return switcher.style["padding-bottom"] = "" + y + "px";
      }
    });
    return enableOpen = function(enable) {
      if (enable == null) {
        enable = true;
      }
      switcherOpen = enable;
      switcher.className = enable ? "open" : "closed";
      if (enable) {
        return setTimeout(function() {
          var clickOutside;
          return window.addEventListener("click", clickOutside = function() {
            window.removeEventListener("click", clickOutside);
            return enableOpen(false);
          });
        });
      }
    };
  });

  Take(["PageLocking", "load"], function(PageLocking) {
    var ScrollHint, aboutToHide, deadband, hide, icon, lastSetPosition, lockedPage, prepareToHide, scrollHint, scrollHintTab, scrollUpdate, show, showing;
    lastSetPosition = 0;
    lockedPage = null;
    aboutToHide = false;
    showing = false;
    deadband = 50;
    icon = null;
    scrollHint = document.createElement("scroll-hint");
    scrollHintTab = document.createElement("scroll-hint-tab");
    scrollHint.appendChild(scrollHintTab);
    document.body.appendChild(scrollHint);
    Make("ScrollHint", ScrollHint = {
      show: function(text, iconText) {
        scrollHintTab.textContent = text;
        if (iconText != null) {
          scrollHintTab.setAttribute("icon-text", iconText);
        } else {
          scrollHintTab.removeAttribute("icon-text");
        }
        lastSetPosition = window.pageYOffset;
        return show();
      },
      hide: function() {
        return prepareToHide();
      }
    });
    show = function() {
      if (!showing) {
        showing = true;
        scrollHintTab.style["-webkit-transform"] = "translateY(0)";
        return scrollHintTab.style.transform = "translateY(0)";
      }
    };
    prepareToHide = function() {
      if (showing && !aboutToHide) {
        aboutToHide = true;
        return setTimeout(hide, 100);
      }
    };
    hide = function() {
      if (aboutToHide && showing) {
        showing = false;
        scrollHintTab.style["-webkit-transform"] = "translateY(100%)";
        scrollHintTab.style.transform = "translateY(100%)";
      }
      return aboutToHide = false;
    };
    (scrollUpdate = function() {
      var scrollMax, tallEnoughToHaveScrollHints;
      tallEnoughToHaveScrollHints = document.body.scrollHeight > window.innerHeight * 2;
      scrollMax = document.body.scrollHeight - window.innerHeight;
      if (showing) {
        if (window.pageYOffset < 0 || window.pageYOffset >= scrollMax) {
          return;
        }
        if (Math.abs(window.pageYOffset - lastSetPosition) > deadband) {
          return prepareToHide();
        } else if (!tallEnoughToHaveScrollHints) {
          return prepareToHide();
        }
      } else if (tallEnoughToHaveScrollHints) {
        if (window.pageYOffset < deadband) {
          return ScrollHint.show("Scroll down to begin.", "⬇︎");
        } else if (window.pageYOffset + deadband >= scrollMax) {
          if (lockedPage != null) {
            return ScrollHint.show("Complete the activity on this page.", "!");
          } else {
            return ScrollHint.show("Good job.");
          }
        }
      }
    })();
    window.addEventListener("scroll", scrollUpdate);
    window.addEventListener("resize", scrollUpdate);
    return PageLocking.onUpdate(function(newLockedPage) {
      if (lockedPage != null) {
        ScrollHint.show("Good job. Scroll down to continue.", "✓");
      }
      return lockedPage = newLockedPage;
    });
  });

  (function() {
    var MAX_SCATTER_SPEED, MAX_TRAVEL_TIME, MIN_SCATTER_SPEED, MIN_TRAVEL_TIME, Particle, SCALE, addVectors, getRandomInRange, map, scalarMultiply;
    SCALE = 1.5;
    MAX_TRAVEL_TIME = 1.5 * SCALE;
    MIN_TRAVEL_TIME = 1.0 * SCALE;
    MAX_SCATTER_SPEED = 240 / SCALE;
    MIN_SCATTER_SPEED = 180 / SCALE;
    addVectors = function(v0, v1) {
      var v;
      return v = {
        x: v0.x + v1.x,
        y: v0.y + v1.y
      };
    };
    scalarMultiply = function(vec, scalar) {
      var v;
      return v = {
        x: vec.x * scalar,
        y: vec.y * scalar
      };
    };
    map = function(input, inputMin, inputMax, outputMin, outputMax, clip) {
      if (clip == null) {
        clip = true;
      }
      if (clip) {
        input = Math.max(Math.min(input, inputMax), inputMin);
      }
      input -= inputMin;
      input /= inputMax - inputMin;
      input *= outputMax - outputMin;
      input += outputMin;
      return input;
    };
    getRandomInRange = function(max, min) {
      return Math.random() * (max - min) + min;
    };
    return Make("Particle", Particle = (function() {
      Particle.prototype.element = null;

      Particle.prototype.x = 0;

      Particle.prototype.y = 0;

      Particle.prototype.pos = 0;

      Particle.prototype.scale = 0;

      Particle.prototype.travelSpeed = 0.0;

      Particle.prototype.scatterSpeed = 0.0;

      Particle.prototype.scatterAngle = 0.0;

      Particle.prototype.scatterForce = null;

      Particle.prototype.scatterTrajectory = null;

      Particle.prototype.target = null;

      function Particle(element) {
        this.element = element;
        this.draw = __bind(this.draw, this);
        this.update = __bind(this.update, this);
        this.setInactive = __bind(this.setInactive, this);
        this.setActive = __bind(this.setActive, this);
        this.setInactive();
      }

      Particle.prototype.setActive = function(sX, sY) {
        this.pos = 0;
        this.x = sX;
        this.y = sY;
        this.scatterTrajectory = {
          x: sX,
          y: sY
        };
        this.travelSpeed = 1 / getRandomInRange(MAX_TRAVEL_TIME, MIN_TRAVEL_TIME);
        this.scatterSpeed = getRandomInRange(MAX_SCATTER_SPEED, MIN_SCATTER_SPEED);
        this.scatterAngle = getRandomInRange(2 * Math.PI, 0);
        return this.scatterForce = {
          x: Math.cos(this.scatterAngle) * this.scatterSpeed,
          y: Math.sin(this.scatterAngle) * this.scatterSpeed
        };
      };

      Particle.prototype.setInactive = function() {
        this.x = -999;
        this.y = -999;
        this.scale = 0;
        return this.draw();
      };

      Particle.prototype.update = function(dT, targetX, targetY) {
        this.pos += this.travelSpeed * dT;
        this.pos = Math.min(this.pos, 1);
        this.scatterTrajectory = addVectors(this.scatterTrajectory, scalarMultiply(this.scatterForce, dT));
        this.x = map(this.pos * this.pos, 0, 1, this.scatterTrajectory.x, targetX);
        this.y = map(this.pos * this.pos * this.pos, 0, 1, this.scatterTrajectory.y, targetY);
        this.scale = Math.abs(Math.sin(this.pos * Math.PI * 4));
        return this.pos >= 1;
      };

      Particle.prototype.draw = function() {
        var transString, x, y;
        x = this.x;
        y = this.y;
        transString = "translate3d(" + this.x + "px, " + this.y + "px, 0px) scale(" + this.scale + ")";
        this.element.style.webkitTransform = transString;
        return this.element.style.transform = transString;
      };

      return Particle;

    })());
  })();

  Take(["Particle", "Scoring", "ScoreDisplay", "load"], function(Particle, Scoring, ScoreDisplay) {
    var POINTS_MAX, active, attachScoreArea, createParticles, createScoreArea, currentTime, draw, fireParticles, inactive, mousePos, scoreArea, startAnimating, stopAnimating, targetElement, targetPos, testParticles, updateMousePos, updateTargetPos;
    POINTS_MAX = 1000;
    inactive = [];
    active = [];
    mousePos = {
      x: 0,
      y: 0
    };
    targetElement = ScoreDisplay.getElement();
    targetPos = {
      x: 0,
      y: 0
    };
    currentTime = null;
    scoreArea = null;
    testParticles = function() {
      fireParticles(1000);
      return setTimeout(testParticles, 4000);
    };
    setTimeout(function() {
      createScoreArea();
      createParticles();
      attachScoreArea();
      return updateTargetPos();
    });
    createScoreArea = function() {
      return scoreArea = document.createElement("score-area");
    };
    createParticles = function() {
      var i, particleElement, _i, _results;
      _results = [];
      for (i = _i = 0; 0 <= POINTS_MAX ? _i < POINTS_MAX : _i > POINTS_MAX; i = 0 <= POINTS_MAX ? ++_i : --_i) {
        particleElement = document.createElement("score-point");
        inactive.push(new Particle(particleElement));
        _results.push(scoreArea.appendChild(particleElement));
      }
      return _results;
    };
    attachScoreArea = function() {
      return document.body.appendChild(scoreArea);
    };
    updateMousePos = function(event) {
      mousePos.x = event.clientX;
      return mousePos.y = event.clientY + window.pageYOffset;
    };
    updateTargetPos = function() {
      var tRect;
      tRect = targetElement.getBoundingClientRect();
      return targetPos = {
        x: tRect.left + tRect.width / 2,
        y: tRect.top + tRect.height / 2 + window.pageYOffset
      };
    };
    draw = function(time) {
      var dT, index, isDone, particle, removeParticles, _i, _j, _len, _len1;
      if (currentTime == null) {
        currentTime = time;
      }
      dT = (time - currentTime) / 1000;
      currentTime = time;
      removeParticles = [];
      for (_i = 0, _len = active.length; _i < _len; _i++) {
        particle = active[_i];
        isDone = particle.update(dT, targetPos.x, targetPos.y);
        if (isDone) {
          removeParticles.push(particle);
          inactive.push(particle);
          particle.setInactive();
        } else {
          particle.draw();
        }
      }
      for (_j = 0, _len1 = removeParticles.length; _j < _len1; _j++) {
        particle = removeParticles[_j];
        index = active.indexOf(particle);
        active.splice(index, 1);
      }
      ScoreDisplay.update(active.length);
      if (active.length > 0) {
        return requestAnimationFrame(draw);
      } else {
        return stopAnimating();
      }
    };
    startAnimating = function() {
      requestAnimationFrame(draw);
      return scoreArea.style.display = "block";
    };
    stopAnimating = function() {
      currentTime = null;
      return scoreArea.style.display = "none";
    };
    fireParticles = function(nParticles) {
      var i, particle, points, _i;
      points = Math.min(nParticles, inactive.length);
      for (i = _i = 0; 0 <= points ? _i < points : _i > points; i = 0 <= points ? ++_i : --_i) {
        particle = inactive[i];
        active.push(particle);
        particle.setActive(mousePos.x, mousePos.y);
      }
      inactive = inactive.splice(points, inactive.length);
      if (active.length > 0) {
        return startAnimating();
      }
    };
    Scoring.onUpdate(function(totalScore, pointsToAward) {
      return fireParticles(pointsToAward);
    });
    window.addEventListener("mousemove", updateMousePos);
    return window.addEventListener("scroll", updateTargetPos);
  });

  Take("load", function() {
    var KEY;
    KEY = "Backend-LocalStorage";
    return Make("Backend", {
      getPersistedData: function() {
        var json;
        json = window.localStorage[KEY];
        if (json != null) {
          return JSON.parse(json);
        }
      },
      setPersistedData: function(data) {
        var json;
        if (data != null) {
          json = JSON.stringify(data);
          window.localStorage[KEY] = json;
          return true;
        } else {
          return false;
        }
      },
      complete: function() {
        return true;
      }
    });
  });

  Make("Easing", {
    inOutCubic: function(t, b, c, d) {
      t /= d / 2;
      if (t < 1) {
        return c / 2 * t * t * t + b;
      } else {
        t -= 2;
        return c / 2 * (t * t * t + 2) + b;
      }
    }
  });

  window.hasAPI = function() {
    return true;
  };

  window.awardPoints = function(percent, exact, name) {
    window.dispatchEvent(new CustomEvent("cdAwardPoints", {
      detail: {
        id: name,
        percent: 100,
        exact: 0
      }
    }));
    return true;
  };

  Take("Backend", function(Backend) {
    var db, hasUnsavedChanges;
    hasUnsavedChanges = false;
    db = Backend.getPersistedData() || {};
    return Make("KVStore", {
      set: function(k, v) {
        hasUnsavedChanges = true;
        return db[k] = v;
      },
      get: function(k) {
        return db[k];
      },
      save: function() {
        if (hasUnsavedChanges) {
          if (Backend.setPersistedData(db)) {
            hasUnsavedChanges = false;
            return true;
          } else {
            return false;
          }
        } else {
          return true;
        }
      }
    });
  });

  Make("MatchesSelector", function(page, selector) {
    if (page.matches != null) {
      return page.matches(selector);
    }
    if (page.msMatchesSelector != null) {
      return page.msMatchesSelector(selector);
    }
    throw new Error("No supported Element.matches() implementation.");
  });

  Take(["PageScrollWatcher"], function(PageScrollWatcher) {
    var PageAudio, audioEnabled, context, currentPageName, decodeFailure, loadAudioForCurrentPage, request, requestPending, setBuffer, source, stopAudio, update, updateListeners;
    audioEnabled = false;
    updateListeners = [];
    currentPageName = null;
    requestPending = false;
    context = null;
    source = null;
    request = new XMLHttpRequest();
    request.addEventListener("load", function() {
      requestPending = false;
      return context.decodeAudioData(request.response, setBuffer, decodeFailure);
    });
    Make("PageAudio", PageAudio = {
      onUpdate: function(listener) {
        updateListeners.push(listener);
        return listener(audioEnabled);
      },
      toggle: function() {
        if (audioEnabled) {
          return PageAudio.disable();
        } else {
          return PageAudio.enable();
        }
      },
      enable: function() {
        if (!audioEnabled) {
          audioEnabled = true;
          if (context == null) {
            context = new (window.AudioContext || window.webkitAudioContext)();
          }
          loadAudioForCurrentPage();
          return update();
        }
      },
      disable: function() {
        if (audioEnabled) {
          audioEnabled = false;
          if (requestPending) {
            request.abort();
          }
          stopAudio();
          return update();
        }
      }
    });
    PageScrollWatcher.onPageChange(function(page) {
      currentPageName = page.id;
      return loadAudioForCurrentPage();
    });
    loadAudioForCurrentPage = function() {
      if ((currentPageName != null) && audioEnabled) {
        if (requestPending) {
          request.abort();
        }
        request.open("GET", "audio/" + currentPageName + ".mp3", true);
        request.responseType = "arraybuffer";
        requestPending = true;
        return request.send();
      }
    };
    setBuffer = function(buffer) {
      stopAudio();
      source = context.createBufferSource();
      source.connect(context.destination);
      source.buffer = buffer;
      return source.start(0);
    };
    decodeFailure = function(e) {
      return console.log("Error decoding audio data", e);
    };
    stopAudio = function() {
      try {
        if (source != null) {
          return source.stop(0);
        }
      } catch (_error) {}
    };
    return update = function() {
      var listener, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = updateListeners.length; _i < _len; _i++) {
        listener = updateListeners[_i];
        _results.push(listener(audioEnabled));
      }
      return _results;
    };
  });

  Take(["Pages", "MatchesSelector"], function(pages, MatchesSelector) {
    var PageManager;
    return Make("PageManager", PageManager = {
      getPages: function() {
        return pages;
      },
      getPagesContainingSelector: function(selector) {
        return pages.filter(function(page, index) {
          return page.querySelector(selector) != null;
        });
      },
      getPageContainingElement: function(element) {
        if (MatchesSelector(element, "cd-page")) {
          return element;
        } else if (element.parentElement != null) {
          return PageManager.getPageContainingElement(element.parentElement);
        } else {
          return null;
        }
      }
    });
  });

  Make("PageTitle", function(page) {
    return page.id.replace(/-/g, " ");
  });

  (function() {
    var EVENTS, pageChange, pageChangeListeners, pageIsCurrent, setupScrollWatching;
    EVENTS = {
      scroll: "scroll"
    };
    pageChangeListeners = [];
    Take("Pages", function(pages) {
      setupScrollWatching(pages);
      return Make("PageScrollWatcher", {
        onPageChange: function(listener) {
          return pageChangeListeners.push(listener);
        }
      });
    });
    setupScrollWatching = function(pages) {
      var prevPage, prevPageIndex, scrollHandlerFn;
      prevPageIndex = null;
      prevPage = null;
      scrollHandlerFn = function() {
        var page, pageIndex, _i, _len;
        for (pageIndex = _i = 0, _len = pages.length; _i < _len; pageIndex = ++_i) {
          page = pages[pageIndex];
          if (pageIsCurrent(page)) {
            if (pageIndex !== prevPageIndex) {
              pageChange(page, pageIndex, prevPage, prevPageIndex);
              prevPageIndex = pageIndex;
              prevPage = page;
            }
            return;
          }
        }
      };
      window.addEventListener(EVENTS.scroll, scrollHandlerFn);
      return setTimeout(scrollHandlerFn);
    };
    pageIsCurrent = function(page) {
      var pageBottom, pageTop, scrollPosition;
      pageTop = page.offsetTop;
      pageBottom = page.offsetTop + page.offsetHeight;
      scrollPosition = window.pageYOffset + document.body.clientHeight / 2;
      return pageTop < scrollPosition && scrollPosition < pageBottom;
    };
    return pageChange = function(page, pageIndex, previousPage, previousPageIndex) {
      var callback, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = pageChangeListeners.length; _i < _len; _i++) {
        callback = pageChangeListeners[_i];
        _results.push(callback(page, pageIndex, previousPage, previousPageIndex));
      }
      return _results;
    };
  })();

  Take("load", function() {
    var pages, pagesNodeList;
    pagesNodeList = document.querySelectorAll("cd-page");
    pages = Array.prototype.slice.call(pagesNodeList);
    Object.freeze(pages);
    return Make("Pages", pages);
  });

  Make("Params", (function() {
    var paramParts, paramString, paramStrings, params, _i, _len;
    params = {};
    paramStrings = window.location.search.substr(1).split("&");
    for (_i = 0, _len = paramStrings.length; _i < _len; _i++) {
      paramString = paramStrings[_i];
      paramParts = paramString.split("=");
      params[paramParts[0]] = paramParts[1] || true;
    }
    return Object.freeze(params);
  })());

  Take(["KVStore", "beforeunload"], function(KVStore, event) {
    if (KVStore.save()) {
      return event.returnValue != null ? event.returnValue : event.returnValue = "Saving changes failed. If you leave now, changes will be lost.";
    }
  });

  Take(["KVStore", "ModalPopup"], function(KVStore, ModalPopup) {
    var callbacks, runSave, saving;
    saving = false;
    callbacks = [];
    runSave = function() {
      var callback, success, _i, _len;
      success = KVStore.save();
      if (success) {
        ModalPopup.close();
      } else {
        ModalPopup.open("Saving Failed", "Check your internet connection and try again.");
      }
      for (_i = 0, _len = callbacks.length; _i < _len; _i++) {
        callback = callbacks[_i];
        setTimeout(function() {
          return callback(success);
        });
      }
      callbacks = [];
      return saving = false;
    };
    return Make("SaveWithPopup", function(callback) {
      callbacks.push(callback);
      if (!saving) {
        saving = true;
        ModalPopup.open("Saving", "Please do not close this page.", false);
        return setTimeout(runSave, 500);
      }
    });
  });

  Take(["PageManager", "KVStore", "Params"], function(PageManager, KVStore, Params) {
    var chapterNode, crawlActivityPoints, createNodeWith, hasPoints, loadScoringTree, makeAPI, moduleNode, moduleTotalPoints, pointsToAward, projectNode, runCallbacks, saveScoringTree, updateCallbacks, updateModuleScore;
    hasPoints = document.querySelector("cd-activity") != null;
    moduleTotalPoints = 0;
    pointsToAward = 0;
    projectNode = null;
    chapterNode = null;
    moduleNode = null;
    updateCallbacks = [];
    setTimeout(function() {
      loadScoringTree();
      if (hasPoints) {
        crawlActivityPoints();
        updateModuleScore();
        saveScoringTree();
        runCallbacks();
      }
      return makeAPI();
    });
    makeAPI = function() {
      return Make("Scoring", {
        addPoints: function(id, percent, exact) {
          var activityNode, scoreBefore, scoreToAward;
          if (percent == null) {
            percent = 0;
          }
          if (exact == null) {
            exact = 0;
          }
          if (!hasPoints) {
            throw new Error("You must add a points attribute to your activity: " + id);
          }
          activityNode = moduleNode.activities[id];
          scoreBefore = activityNode.score;
          scoreToAward = percent + (exact / activityNode.points);
          if (activityNode.score == null) {
            activityNode.score = 0;
          }
          activityNode.score += scoreToAward;
          activityNode.score = Math.min(activityNode.score, 1);
          activityNode.score = Math.round(activityNode.score * 1000) / 1000;
          pointsToAward = (activityNode.score - scoreBefore) * activityNode.points;
          updateModuleScore();
          saveScoringTree();
          return runCallbacks();
        },
        getActivityScore: function(id) {
          return moduleNode.activities[id].score;
        },
        getModulePoints: function() {
          return moduleTotalPoints;
        },
        getModuleScore: function() {
          return moduleNode.score;
        },
        onUpdate: function(callback) {
          return updateCallbacks.push(callback);
        }
      });
    };
    loadScoringTree = function() {
      var _base, _base1, _name, _name1;
      projectNode = KVStore.get(Params.project) || createNodeWith("chapters");
      chapterNode = (_base = projectNode.chapters)[_name = Params.chapter] != null ? _base[_name] : _base[_name] = createNodeWith("modules");
      return moduleNode = (_base1 = chapterNode.modules)[_name1 = Params.module] != null ? _base1[_name1] : _base1[_name1] = createNodeWith("activities");
    };
    createNodeWith = function(groupName) {
      var node;
      node = {};
      node.score = 0;
      node[groupName] = {};
      return node;
    };
    crawlActivityPoints = function() {
      var activity, name, points, _base, _base1, _i, _len, _ref, _results;
      moduleTotalPoints = 0;
      _ref = document.querySelectorAll("cd-activity");
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        activity = _ref[_i];
        name = activity.id;
        points = parseInt(activity.getAttribute("points"));
        if ((_base = moduleNode.activities)[name] == null) {
          _base[name] = {};
        }
        if ((_base1 = moduleNode.activities[name]).score == null) {
          _base1.score = 0;
        }
        moduleNode.activities[name].points = points;
        _results.push(moduleTotalPoints += points);
      }
      return _results;
    };
    updateModuleScore = function() {
      var activityNode, earnedPoints, name, _ref;
      earnedPoints = 0;
      _ref = moduleNode.activities;
      for (name in _ref) {
        activityNode = _ref[name];
        earnedPoints += activityNode.score * activityNode.points;
      }
      return moduleNode.score = earnedPoints / moduleTotalPoints;
    };
    saveScoringTree = function() {
      KVStore.set(Params.project, projectNode);
      return KVStore.save();
    };
    return runCallbacks = function() {
      var call, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = updateCallbacks.length; _i < _len; _i++) {
        call = updateCallbacks[_i];
        _results.push(call(moduleNode.score, pointsToAward));
      }
      return _results;
    };
  });

  Take("Scoring", function(Scoring) {
    return window.addEventListener("cdAwardPoints", function(e) {
      var exact, id, percent;
      id = e.detail.id;
      percent = e.detail.percent;
      exact = e.detail.exact;
      if (id == null) {
        throw new Error("Activity events must provide an id.");
      }
      if (!((percent != null) || (exact != null))) {
        throw new Error("Activity events must provide either a percent or exact: " + id);
      }
      return Scoring.addPoints(id, percent, exact);
    });
  });

  Take("Easing", function(Easing) {
    var SCROLL_ANIMATION_SPEED;
    SCROLL_ANIMATION_SPEED = 500;
    return Make("ScrollTo", function(startHeight, heightDiff) {
      var animate, currentTime, duration, startTime;
      if (heightDiff === 0) {
        return;
      }
      startTime = null;
      currentTime = 0;
      duration = Math.sqrt(Math.abs(heightDiff * SCROLL_ANIMATION_SPEED));
      animate = function(systemTime) {
        var height;
        if (startTime == null) {
          startTime = systemTime;
        }
        currentTime = systemTime - startTime;
        if (currentTime > duration) {
          currentTime = duration;
        }
        height = Easing.inOutCubic(currentTime, startHeight, heightDiff, duration);
        document.body.scrollTop = height;
        if (currentTime < duration) {
          return requestAnimationFrame(animate);
        }
      };
      return requestAnimationFrame(animate);
    });
  });

  Take(["ModalPopup"], function(ModalPopup) {
    var KEY, container, img, text;
    KEY = "WelcomePopup";
    container = document.createElement("div");
    container.style.width = "292px";
    img = document.createElement("img");
    img.src = "data:image/png;base64,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";
    img.style["margin-bottom"] = "-50px";
    container.appendChild(img);
    text = document.createTextNode("In the bottom left corner, you'll find buttons that take you back to the main menu, turn voice-over narration on and off, or quickly switch pages.");
    container.appendChild(text);
    if (window.localStorage[KEY] == null) {
      window.localStorage[KEY] = true;
      return ModalPopup.open("Welcome", container);
    }
  });

}).call(this);
